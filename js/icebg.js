var renderer,scene,camera,composer,lights,circle,skelet,particle,planet,planet2,audioArray,user_audio_amp,audio_wireframe=!0,primaryColor=null,secondaryColor=null,thirdColor=null,bg_file,move_bg,bass_wireframe;function loadScript(e,t){var a=document.createElement("script"),n=document.getElementsByTagName("head")[0];a.type="text/javascript",a.charset="UTF-8",a.src=e,a.addEventListener?a.addEventListener("load",(function(){t()}),!1):a.attachEvent&&a.attachEvent("onreadystatechange",(function(){"loaded"==window.event.srcElement.readyState&&t()})),n.appendChild(a)}function loadlived(){document.getElementById("web-bg").offsetWidth>800&&(document.onreadystatechange=function(){"complete"==document.readyState&&(loadScript("https://cdn.jsdelivr.net/gh/wxydejoy/wxy_bg@main/vendor/simplex-noise.min.js",(function(){})),loadScript("https://cdn.jsdelivr.net/gh/wxydejoy/wxy_bg@main/vendor/three.min.js",(function(){init(),animate()})))})}function loadbg(){GLOBAL_CONFIG_SITE.isPost||loadlived()}function rgb2hex(e){return(e=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===e.length?""+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):""}function init(){(renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!0})).setSize(document.getElementById("web-bg").offsetWidth,document.getElementById("web_bg").offsetHeight),document.getElementById("web_bg").appendChild(renderer.domElement),scene=new THREE.Scene,(camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1e3)).position.z=400,scene.add(camera),circle=new THREE.Object3D,skelet=new THREE.Object3D,particle=new THREE.Object3D,scene.add(circle),scene.add(skelet),scene.add(particle);var e=new THREE.TetrahedronGeometry(2,0),t=new THREE.IcosahedronGeometry(7,1);t.verticesNeedUpdate=!0;for(var a=new THREE.IcosahedronGeometry(15,1),n=new THREE.MeshPhongMaterial({color:16777215,shading:THREE.FlatShading}),r=0;r<100;r++){var i=new THREE.Mesh(e,n);i.position.set(Math.random()-.5,Math.random()-.5,Math.random()-.5).normalize(),i.position.multiplyScalar(90+700*Math.random()),i.rotation.set(2*Math.random(),2*Math.random(),2*Math.random()),particle.add(i)}var o=new THREE.MeshPhongMaterial({color:1334141,shading:THREE.FlatShading}),s=new THREE.MeshPhongMaterial({color:16777215,wireframe:!0,side:THREE.DoubleSide});(planet=new THREE.Mesh(t,o)).verticesNeedUpdate=!0,planet.scale.x=planet.scale.y=planet.scale.z=16,circle.add(planet),(planet2=new THREE.Mesh(a,s)).scale.x=planet2.scale.y=planet2.scale.z=10,skelet.add(planet2);var c=new THREE.AmbientLight(10066329);scene.add(c),(lights=[])[0]=new THREE.DirectionalLight(16777215,1),lights[0].position.set(1,0,0),lights[1]=new THREE.DirectionalLight(71740,1),lights[1].position.set(.75,1,.5),lights[2]=new THREE.DirectionalLight(17263,1),lights[2].position.set(-.75,-1,.5),scene.add(lights[0]),scene.add(lights[1]),scene.add(lights[2])}function moveObject(e,t,a,n=0){"add"===t&&(e+=a),"subtract"===t&&(e-=a),"bounce"===t&&(e.x+=a,e.y+=a,e.z+=a,setTimeout((()=>{e.x-=a,e.y-=a,e.z-=a}),n))}function animate(){var noise=new SimplexNoise;requestAnimationFrame(animate);var planets=[planet,planet2],planets;if(void 0!==audioArray){var user_amp=eval("1.".concat(user_audio_amp||"80")),bass_user_amp=eval("0.".concat(user_audio_amp||"80"));planets.map((function(e){e.geometry.vertices.forEach((function(t,a){var n=audioArray[a];audioArray.reduce((function(e,t){return e+t}))<=2&&(n*=10);var r,i=e.geometry.parameters.radius;if(t.normalize(),100===user_audio_amp)bass_user_amp=1,r=i+(n*=2)*user_amp;else{n*=user_amp;var o=Date.now(),s=t.x+5e-4*o,c=t.y+5e-4*o,d=t.z+5e-4*o;r=i+noise.noise3D(s,c,d)*n}var l=1-bass_user_amp;if(l<=.3&&(l=.3),a<=3&&n>l&&(!1===audio_wireframe&&bass_wireframe&&(audio_wireframe=!0,setTimeout((function(){audio_wireframe=!1}),250)),move_bg)){particle.rotation.x+=5e-4*Math.random(),particle.rotation.y-=.004*Math.random(),circle.rotation.x+=.002,circle.rotation.y-=.004;var m=100*n/.2;moveObject(skelet.position,"bounce",.05,m),moveObject(e.position,"bounce",.05,m),moveObject(particle.position,"bounce",.05,m)}t.multiplyScalar(r<=.1?1:r)})),e.geometry.verticesNeedUpdate=!0,e.geometry.normalsNeedUpdate=!0,e.geometry.computeVertexNormals(),e.geometry.computeFaceNormals()}))}particle.rotation.x+=0,particle.rotation.y-=.001,circle.rotation.x-=.002,circle.rotation.y-=.003,skelet.rotation.x-=.001,skelet.rotation.y+=.002,renderer.clear(),renderer.render(scene,camera)}loadbg();